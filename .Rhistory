geom_line() +  # Connects the points with a line
geom_point() +  # Adds points at each data point
labs(title="Total Number of Mutations Per Year",
x="Year",
y="Total Mutations") +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))  # Rotate x-axis labels for better readability
total_mutations_per_year$Year <- as.numeric(as.character(total_mutations_per_year$Year))
total_records_per_year$Year <- as.numeric(as.character(total_records_per_year$Year))
# Merge the datasets
yearly_data <- merge(total_mutations_per_year, total_records_per_year, by = "Year")
# Calculate mutation rate
yearly_data$mutation_rate <- with(yearly_data, total_mutations / total_records)
ggplot(yearly_data, aes(x = Year, y = mutation_rate)) +
geom_line(color = "darkgreen", size = 1) +  # Draw the line
geom_point(color = "darkred", size = 2) +  # Highlight each year's mutation rate
labs(title = "Mutation Rate Per Year",
x = "Year",
y = "Mutation Rate (Mutations per Record)") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Finally, plot mutation rate per year, separated by mutation type
ggplot(yearly_data, aes(x = Year, y = mutation_rate, group = mutation_type, color = mutation_type)) +
geom_line() +  # Draw the line for each mutation type
geom_point() +  # Highlight each year's mutation rate for each mutation type
labs(title = "Mutation Rate Per Year by Mutation Type",
x = "MMWR Year",
y = "Mutation Rate (Mutations per Record)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better readability
NREVSS_clinic <- NREVSS_clinic %>%
group_by(REGION, YEAR) %>%
summarize(TOTAL_SPECIMENS = sum(TOTAL.SPECIMENS, na.rm = TRUE),
TOTAL_A = sum(TOTAL.A, na.rm = TRUE),
TOTAL_B = sum(TOTAL.B, na.rm = TRUE),
PERCENT_POSITIVE = mean(PERCENT.POSITIVE, na.rm = TRUE),
.groups = 'drop')
vaccination_coverage_raw <- vaccination_coverage_raw %>%
mutate(YEAR = as.numeric(sub("-.*", "", `Season.Survey.Year`)))
ili <- ili %>%
mutate(YEAR = as.numeric(YEAR))
NREVSS_clinic <- NREVSS_clinic %>%
mutate(YEAR = as.numeric(YEAR))
NREVSS_combined <- NREVSS_combined %>%
mutate(YEAR = as.numeric(YEAR))
nuc_flu <- nuc_flu %>%
mutate(YEAR = as.numeric(Year))
# Extract the region from the 'name' column of nuc_flu
nuc_flu <- nuc_flu %>%
mutate(REGION = str_extract(name, "\\(A/([A-Za-z]+)")) %>%
mutate(REGION = str_remove(REGION, "\\(A/"))
#combined_data <- nuc_flu %>%
#full_join(ili, by = c("YEAR"))
#cor_result <- cor(combined_data$Estimate, combined_data$PERCENT.POSITIVE, use = "complete.obs", method = "pearson")
#lm_result  <- lm(PERCENT_POSITIVE ~ Estimate + TOTAL_A + TOTAL_B, data = combined_data)
#glm_result <- glm(mutation_presence ~ Estimate + mutations, family = binomial, data = combined_data)
#summary(lm_result)
#summary(glm_result)
#str(NREVSS_combined$YEAR)
#str(NREVSS_clinic$YEAR)
#str(ili$YEAR)
#str(nuc_flu$YEAR)
#str(vaccination_coverage_raw$YEAR)
#head(ili)
#colnames(vaccination_coverage_raw)
#str(vaccination_coverage_raw$YEAR)
#colnames(NREVSS_clinic)
# Convert ISO_WEEKSTARTDATE to Date type
who2$ISO_WEEKSTARTDATE <- as.Date(who2$ISO_WEEKSTARTDATE)
who2$Year  <- format(who2$ISO_WEEKSTARTDATE, "%Y") # Extract year
who2$Month <- format(who2$ISO_WEEKSTARTDATE, "%m") # Extract month
# Get last day of each month
who2$LastDoM <- as.Date(paste(who2$Year, who2$Month, "01", sep = "-")) + 31 - 1
# Check if day <= two days from EoM
who2$TwoOrLessDaysToEoM <- (who2$LastDoM - who2$ISO_WEEKSTARTDATE) <= 2
# Create new column for edited ISO_WEEKSTARTDATE
who2$Edit_ISO_WEEKSTARTDATE <- who2$ISO_WEEKSTARTDATE
# If day <= two days from EoM, move it to next month
who2$Edit_ISO_WEEKSTARTDATE[who2$TwoOrLessDaysToEoM] <- who2$ISO_WEEKSTARTDATE[who2$TwoOrLessDaysToEoM] + 31
# If moved past December, change year to next year
who2$Year[who2$Month == "12" & who2$TwoOrLessDaysToEoM] <- as.numeric(who2$Year[who2$Month == "12" & who2$TwoOrLessDaysToEoM]) + 1
who2$Month[who2$Month == "12" & who2$TwoOrLessDaysToEoM] <- "01"
head(who2)
# columns to keep from who2
keep_cols <- c("COUNTRY_CODE", "ORIGIN_SOURCE",
"SPEC_PROCESSED_NB", "ANOTSUBTYPED",
"AH1", "AH3", "AH5", "AH7N9",
"INF_A", "BVIC_NODEL", "BYAM", "BNOTDETERMINED", "INF_B", "INF_ALL",
"INF_NEGATIVE", "ILI_ACTIVITY",
"Year", "Month")
# Filter only USA columns, then only keep columns listed above.
who_df     <- subset(who2, COUNTRY_CODE == "USA", select = keep_cols)
front_cols <- c("Year", "Month")
# Move Year and Month to front of dataframe.
who_df      <- who_df[, c(front_cols, setdiff(names(who_df), front_cols))]
who_df$Year <- as.integer(who_df$Year)
who_df$Month <- as.integer(who_df$Month)
sum_cols <- c("SPEC_PROCESSED_NB", "ANOTSUBTYPED",
"AH1", "AH3", "AH5", "AH7N9",
"INF_A", "BVIC_NODEL", "BYAM", "BNOTDETERMINED", "INF_B", "INF_ALL",
"INF_NEGATIVE", "ILI_ACTIVITY")
# Cleans data for merging to reduce redundancies.
who_mthly_summary <- who_df %>%
group_by(Year, Month, ORIGIN_SOURCE) %>%
summarise(across(sum_cols, sum))
who_yrly_summary <- who_df %>%
group_by(Year, ORIGIN_SOURCE) %>%
summarise(across(sum_cols, sum))
who_agg_df <- who_mthly_summary %>%
group_by(Year, Month) %>%
summarise(Total_INF_ALL = sum(INF_ALL))
library(tidyverse); library(scales); library(ggplot2)
library(dplyr); library(MMWRweek); library(stringr); library(caTools)
# Starting linear regression of years to detections
split1 = sample.split(who_agg_df$Total_INF_ALL, SplitRatio = 0.7)
train1 = subset(who_agg_df, split1 == TRUE)
test1 = subset(who_agg_df, split1 == FALSE)
# Fitting Simple Linear Regression to the Training set
lm.r1= lm(formula = Total_INF_ALL ~ Year,
data = train1)
#Summary of the model
summary(lm.r1)
new_data1 = data.frame(Year = c(2025, 2026, 2027, 2028))
predicted_detections1 = predict(lm.r1, newdata = new_data1)
print(predicted_detections1)
ggplot() + geom_point(aes(x = train1$Year,
y = train1$Total_INF_ALL), colour = 'red') +
geom_line(aes(x = train1$Year,
y = predict(lm.r1, newdata = train1)), colour = 'blue') +
labs(x = "Year", y = "All Influenza Detections")
# summary: This regression model is meant to represent the overall trend of data regarding total Influenza detections. While it does not fully account for the increase in extreme
# outliers following the year 2015, the trend seems to have a steady positive incline at the very least.
who_agg_a <- who_mthly_summary %>%
group_by(Year, Month) %>%
summarise(Total_INF_A = sum(INF_A))
who_agg_b <- who_mthly_summary %>%
group_by(Year, Month) %>%
summarise(Total_INF_B = sum(INF_B))
# Starting linear regression of years to detections
split2 = sample.split(who_agg_a$Total_INF_A, SplitRatio = 0.7)
train2 = subset(who_agg_a, split2 == TRUE)
test2 = subset(who_agg_a, split2 == FALSE)
# Fitting Simple Linear Regression to the Training set
lm.r2= lm(formula = Total_INF_A ~ Year,
data = train2)
#Summary of the model
summary(lm.r2)
new_data2 = data.frame(Year = c(2025, 2026, 2027, 2028))
predicted_detections2 = predict(lm.r2, newdata = new_data2)
print(predicted_detections2)
ggplot() + geom_point(aes(x = train2$Year,
y = train2$Total_INF_A), colour = 'red') +
geom_line(aes(x = train2$Year,
y = predict(lm.r2, newdata = train2)), colour = 'blue') +
labs(x = "Year", y = "Influenza A (Total) Detections")
# summary: This regression model accounts for Influenza type A detections. This model has a steeper trend with notable outliers following the spike after 2015.
# Starting linear regression of years to detections
split3 = sample.split(who_agg_b$Total_INF_B, SplitRatio = 0.7)
train3 = subset(who_agg_b, split3 == TRUE)
test3 = subset(who_agg_b, split3 == FALSE)
# Fitting Simple Linear Regression to the Training set
lm.r3= lm(formula = Total_INF_B ~ Year,
data = train3)
#Summary of the model
summary(lm.r3)
new_data3 = data.frame(Year = c(2025, 2026, 2027, 2028))
predicted_detections3 = predict(lm.r3, newdata = new_data3)
print(predicted_detections3)
ggplot() + geom_point(aes(x = train3$Year,
y = train3$Total_INF_B), colour = 'red') +
geom_line(aes(x = train3$Year,
y = predict(lm.r3, newdata = train3)), colour = 'blue') +
labs(x = "Year", y = "Influenza B (total) Detections")
# summary: this model accounts for detections of Influenza type B. This model doesn't seem to have as much of an incline as the previous two, probably due to the lack of outliers and the centralization of data points below the line, despite the outliers themselves being disproportionally high.
library(dplyr)
library(cluster)
library(ggplot2)
specific_regions <- c("Region 1", "Region 2", "Region 3", "Region 4", "Region 5",
"Region 6", "Region 7", "Region 8", "Region 9", "Region 10")
VC_specific_regions <- VC_filtered_numeric %>%
filter(grepl("Region", Geography) & Geography %in% specific_regions & Dimension.Type == "Race and Ethnicity")
selected_vars <- VC_specific_regions[, c("Geography", "Dimension", "Estimate....")]
clustered_data <- selected_vars %>%
group_by(Geography) %>%
do({
km <- kmeans(.$Estimate...., centers = 2)  # Number of clusters (you can adjust this)
data.frame(., Cluster = km$cluster)
})
vac_cover_cluster_plot = ggplot(clustered_data, aes(x = Geography, y = Estimate...., color = as.factor(Cluster), shape = Dimension)) +
geom_point() +
labs(title = "Clustering Analysis with Specific Regions and Race/Ethnicity Dimension",
x = "Region",
y = "Estimate....",
color = "Cluster",
shape = "Race/Ethnicity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
vac_cover_cluster_plot
library(dplyr)
library(ggplot2)
VC_filtered_numeric$Season.Survey.Year <- factor(VC_filtered_numeric$Season.Survey.Year, levels = unique(VC_filtered_numeric$Season.Survey.Year))
VC_filtered_numeric <- VC_filtered_numeric %>%
mutate(Month.Index = 12 * (as.integer(substr(Season.Survey.Year, 1, 4)) - 2009) + Month)
lm_model <- lm(Estimate.... ~ Month.Index, data = VC_filtered_numeric)
lm_scatter_plot <- ggplot(VC_filtered_numeric, aes(x = Month.Index, y = Estimate...., color = Sample.Size)) +
geom_point() +
labs(title = "Coverage Through Time with Linear Regression Model (Accounting for Sample Size)",
x = "Month Index",
y = "Vaccine Coverage Estimate (%)",
subtitle = "Months within each year are ordered sequentially from 1 to 12",
color = "Sample Size") +
scale_x_continuous(breaks = seq(1, max(VC_filtered_numeric$Month.Index), by = 12),
labels = unique(VC_filtered_numeric$Season.Survey.Year)) +
scale_color_viridis_c() +  # Using the viridis color palette
theme(axis.text.x = element_text(angle = 45, hjust = 1))
lm_scatter_plot +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", size = 1, data = VC_filtered_numeric)
lm_model
library(shiny)
library(shinythemes)
library(ggplot2)
library(tidyr)
# Define UI for the application
ui <- fluidPage(
theme = shinytheme("flatly"),
navbarPage(
"Influenza Analysis",
tabPanel("Overview",
verbatimTextOutput("text_output"),
htmlOutput("html_output")
),
tabPanel("EDA",
fluidRow(
column(width = 12,
selectInput("plot_selector", "Select EDA Option:",
choices = c("Influenza Type A Detections",
"Influenza Type B Detections",
"Influenza A Subtype Detections",
"Influenza B Subtype Detections",
"Mutations Data",
"Mutation Count per Year",
"Vaccination Coverage",
"Vaccination Coverage (Age Range)"),
selected = "Influenza Detections")
)
),
fluidRow(
column(width = 12,
uiOutput("plot_output")
)
)
),
tabPanel("Models",
fluidRow(
column(width = 12,
selectInput("model_plot_selector", "Select Model:",
choices = c("Total Influenza Regression",
"Influenza A Regression",
"Influenza B Regression",
"Influenza Hierarchical Clustering (Complete)",
"Influenza Hierarchical Clustering (Average)",
"Influenza Hierarchical Clustering (Single)",
"Vaccine Coverage Regression",
"Vaccine Coverage Clustering"),
selected = "Linear Regression")
)
),
fluidRow(
column(width = 12,
uiOutput("model_plot_output")
)
)
)
)
)
# Define server logic
server <- function(input, output) {
output$plot_output <- renderUI({
if (input$plot_selector == "Influenza Type A Detections") {
plot_output <- plotOutput("plot_influenza_detections_A")
summary_text <- "This accounts for data points regarding Influenza type A detections, incremented by year,  ranging from 1997-2024, with 12 data points for every year representing monthly detections. We can see that the data points take a notable leap following the year 2015, with no signs of decline."
} else if (input$plot_selector == "Influenza Type B Detections") {
plot_output <- plotOutput("plot_influenza_detections_B")
summary_text <- "This accounts for Influenza type B detections, also ranging from 1997-2024. It is worth noting that while Influenza type B only has ~1/3rd of the amount of detections, it still carries a similar trend to Influenza type A, in that they are both facing significant spikes following 2015."
} else if (input$plot_selector == "Influenza A Subtype Detections") {
plot_output <- plotOutput("plot_influenza_detections_Asub")
summary_text <- "The most notable A subtypes are also plotted against each other to compare virulence of different strains over time. The AH1 sub strain seems to be prevalent alongside AH3, up until a spike around the year 2010, when AH1 starts to drop off, a new strain AH5 gains new data but then also falls off completely with AH1 around 2015. By this time, the sub strain AH3 has skyrocketed in detections, dominating and replacing the other two strains completely."
} else if (input$plot_selector == "Influenza B Subtype Detections") {
plot_output <- plotOutput("plot_influenza_detections_Bsub")
summary_text <- "The most notable influenza B subtypes followed a similar trend to AH3, where they both seem to spike around the year 2015, similarly to the general trends of A and B. The drop off that happens around 2020 for the B-Yamagata strain (BYAM), when compared to the upward spike that happens for the B-Victorian strain (BVIC) in the following years, could indicate that the latter has taken over a good majority of cases among reported B subtypes."
} else if (input$plot_selector == "Mutations Data") {
plot_output <- plotOutput("plot_mutations_data")
summary_text <- "This plot shows the distribution of mutations in the influenza virus."
} else if (input$plot_selector == "Mutation Count per Year") {
plot_output <- plotOutput("plot_mutation_count_year")
summary_text <- "This plot shows the distribution of mutations in the influenza virus over each year from 2000 to 2023."
} else if (input$plot_selector == "Vaccination Coverage") {
plot_output <- plotOutput("plot_vaccination_coverage")
summary_text <- "This plot visualizes the vaccination coverage for influenza for each month of the year."
} else if (input$plot_selector == "Vaccination Coverage (Age Range)") {
plot_output <- plotOutput("plot_vaccination_coverage_age_dist")
summary_text <- "This plot displays the vaccination coverage distributions for each risk group."
}
list(plot_output = plot_output, summary_text = summary_text)
})
output$model_plot_output <- renderUI({
if (input$model_plot_selector == "Total Influenza Regression") {
model_plot_output <- plotOutput("plot_influenza_detections_Allreg")
summary_text <- "This regression model is meant to represent the overall trend of data regarding total Influenza detections. While it does not          fully account for the increase in extreme outliers following the year 2015, the trend seems to have a notable positive incline. The fact that         outliers seem to only become more abundant, we can expect trends like these will only increase over time."
} else if (input$model_plot_selector == "Influenza A Regression") {
model_plot_output <- plotOutput("plot_influenza_detections_Areg")
summary_text <- "This regression model accounts for Influenza type A detections. This model's trend is to be expected given the previous                regression model. We can look at this as one half of that model. It's worth noting that the spike in outliers seems to happen earlier than            previously seen with the general trend, with a notable increase around the year 2009, only barely stagnating until the general spike of 2015."     } else if (input$model_plot_selector == "Influenza B Regression") {
model_plot_output <- plotOutput("plot_influenza_detections_Breg")
summary_text <- "This model accounts for detections of Influenza type B. This model doesn't seem to have as much of an incline as the previous          two, probably due to the lack of outliers and the centralization of data points below the line, despite the outliers themselves being                 disproportionally high. This could also be due to the fact that extreme outliers don't seem to show up until a few years after the spike of           2015, and they seem to have been dropping off a bit after 2020."
} else if (input$model_plot_selector == "Influenza Hierarchical Clustering (Complete)"){
model_plot_output <- plotOutput("plot_influenza_hierarchy_cluster_complete")
summary_text <- "The HC was meant to reflect the correct number of clusters to group the antigen occurrences into.  This showed that there were two antigen occurences that were completely on their own, likely the testing negative for antigens, and two main groups after that, likely the individual tested positive for A or B antigens.  This holds true for complete (maximum), average, and single (minimum) linkage.
In complete linkage, the distance between two clusters is defined as the maximum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be less sensitive to outliers compared to other methods. In average linkage, the distance between two clusters is defined as the average distance between each data point in one cluster and each data point in the other cluster. It tends to produce more balanced clusters and is less sensitive to outliers compared to complete linkage. In single linkage, the distance between two clusters is defined as the minimum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be more sensitive to outliers compared to complete and average linkage."
} else if (input$model_plot_selector == "Influenza Hierarchical Clustering (Average)"){
model_plot_output <- plotOutput("plot_influenza_hierarchy_cluster_average")
summary_text <- "The HC was meant to reflect the correct number of clusters to group the antigen occurrences into.  This showed that there were two antigen occurences that were completely on their own, likely the testing negative for antigens, and two main groups after that, likely the individual tested positive for A or B antigens.  This holds true for complete (maximum), average, and single (minimum) linkage.
In complete linkage, the distance between two clusters is defined as the maximum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be less sensitive to outliers compared to other methods. In average linkage, the distance between two clusters is defined as the average distance between each data point in one cluster and each data point in the other cluster. It tends to produce more balanced clusters and is less sensitive to outliers compared to complete linkage. In single linkage, the distance between two clusters is defined as the minimum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be more sensitive to outliers compared to complete and average linkage."
} else if (input$model_plot_selector == "Influenza Hierarchical Clustering (Single)"){
model_plot_output <- plotOutput("plot_influenza_hierarchy_cluster_single")
summary_text <- "The HC was meant to reflect the correct number of clusters to group the antigen occurrences into.  This showed that there were two antigen occurences that were completely on their own, likely the testing negative for antigens, and two main groups after that, likely the individual tested positive for A or B antigens.  This holds true for complete (maximum), average, and single (minimum) linkage.
In complete linkage, the distance between two clusters is defined as the maximum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be less sensitive to outliers compared to other methods. In average linkage, the distance between two clusters is defined as the average distance between each data point in one cluster and each data point in the other cluster. It tends to produce more balanced clusters and is less sensitive to outliers compared to complete linkage. In single linkage, the distance between two clusters is defined as the minimum distance between any single data point in one cluster and any single data point in the other cluster. It tends to be more sensitive to outliers compared to complete and average linkage."
} else if (input$model_plot_selector == "Vaccine Coverage Regression"){
model_plot_output <- plotOutput("plot_vaccine_coverage_reg")
summary_text <- "This depicts the general trend of vaccination coverage in the United States over a 15-year period, using linear regression analysis on monthly data points. Despite variations in sample sizes, a consistent pattern emerges, with coverage typically starting low in September, rising steadily through May, and then sharply dropping at the onset of the next year. The addition of a color gradient based on sample size adds clarity, revealing areas with larger populations. Notably, the analysis shows a marginal yearly increase of 0.001881%, suggesting a stable trend across the years."
} else if (input$model_plot_selector == "Vaccine Coverage Clustering"){
model_plot_output <- plotOutput("plot_vaccine_coverage_cluster")
summary_text <- "The attempt to utilize cluster analysis to discern patterns in vaccination coverage across states initially showed promise. However, despite various attempts with different configurations and dimensions, the results were limited, primarily grouping states with low coverage percentages together. Even expanding the scope to regional analysis did not yield significant insights, as the sheer volume of data points overwhelmed the clustering algorithm. This suggests that the complexity of vaccination coverage data may not lend itself well to traditional cluster analysis techniques."
}
list(plot_output = model_plot_output, summary_text = summary_text)
})
output$plot_influenza_detections_A <- renderPlot({
ggplot(who_mthly_summary) +
geom_point(aes(Year, INF_A), na.rm=TRUE) +
labs(y="Influenza A (Total) Detections")
})
output$plot_influenza_detections_B <- renderPlot({
ggplot(who_mthly_summary) +
geom_point(aes(Year, INF_B), na.rm=TRUE) +
labs(y="Influenza B (total) Detections")
})
output$plot_influenza_detections_Asub <- renderPlot({
who_mthly_summary %>%
pivot_longer(AH1:AH5, names_to="subtype", values_to="reports") %>%
ggplot(aes(x=Year, y=reports)) +
geom_point() + facet_wrap(vars(subtype)) +
labs(x="Year", y="Influenza A (subtype) Detections")
})
output$plot_influenza_detections_Bsub <- renderPlot({
who_mthly_summary %>%
pivot_longer(BVIC_NODEL:BYAM, names_to="subtype", values_to="reports") %>%
ggplot(aes(x=Year, y=reports)) +
geom_point() + facet_wrap(vars(subtype)) +
labs(x="Year", y="Influenza B (subtype) Detections")
})
output$plot_mutations_data <- renderPlot({ggplot(yearly_data, aes(x = Year, y = mutation_rate, group = mutation_type, color = mutation_type)) +
geom_line() +  # Draw the line for each mutation type
geom_point() +  # Highlight each year's mutation rate for each mutation type
labs(title = "Mutation Rate Per Year by Mutation Type",
x = "MMWR Year",
y = "Mutation Rate (Mutations per Record)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better readability
})
output$plot_mutation_count_year <- renderPlot({
ggplot(mutation_counts_per_year, aes(x=factor(Year), y=count, fill=mutations)) +
geom_bar(stat="identity", position="fill") +
labs(title="Distribution of Mutation Types by Year",
x="Year",
y="Count of Mutations",
fill="Mutation Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle=45, hjust=1))
})
output$plot_vaccination_coverage <- renderPlot({
ggplot(average_data, aes(x = Month, y = Avg_Estimate, color = Dimension)) +
geom_point() +
geom_line() +
labs(title = "Average Coverage by Race/Ethnicity over Time",
x = "Month", y = "Average Vaccine Coverage%") +
scale_x_continuous(breaks = 1:12) +
scale_y_continuous(limits = c(0, 50)) +
scale_color_manual(values = c(
"American Indian or Alaska Native, Non-Hispanic" = "red",
"Asian, Non-Hispanic" = "blue",
"Black, Non-Hispanic" = "green",
"Hispanic" = "orange",
"Other or Multiple Races, Non-Hispanic" = "purple",
"White, Non-Hispanic" = "yellow"
))
})
output$plot_vaccination_coverage_age_dist <- renderPlot({
ggplot(VC_age, aes(x = factor(category), y = Estimate...., fill = category)) +
geom_boxplot() +
scale_fill_manual(values = c('blue', 'red')) +  # Set the colors for the categories
labs(title = "Coverage by Age Group",
x = "Category", y = "Vaccine Coverage% Estimate") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
})
#Next plots are linear regression models
output$plot_influenza_detections_Allreg <- renderPlot({
ggplot() + geom_point(aes(x = train1$Year,
y = train1$Total_INF_ALL), colour = 'red') +
geom_line(aes(x = train1$Year,
y = predict(lm.r1, newdata = train1)), colour = 'blue') +
labs(x = "Year", y = "All Influenza Detections")   })
output$plot_influenza_detections_Areg <- renderPlot({
ggplot() + geom_point(aes(x = train2$Year,
y = train2$Total_INF_A), colour = 'red') +
geom_line(aes(x = train2$Year,
y = predict(lm.r2, newdata = train2)), colour = 'blue') +
labs(x = "Year", y = "Influenza A (Total) Detections")   })
output$plot_influenza_detections_Breg <- renderPlot({
ggplot() + geom_point(aes(x = train3$Year,
y = train3$Total_INF_B), colour = 'red') +
geom_line(aes(x = train3$Year,
y = predict(lm.r3, newdata = train3)), colour = 'blue') +
labs(x = "Year", y = "Influenza B (Total) Detections")   })
output$plot_influenza_hierarchy_cluster_complete <- renderPlot({
plot(hc.com, main="Detected Antigens Complete Linkage",xlab="",sub="",cex=.7)
})
output$plot_influenza_hierarchy_cluster_average <- renderPlot({
plot(hc.avg, main="Detected Antigens Average Linkage",xlab="",sub="",cex=.7)
})
output$plot_influenza_hierarchy_cluster_single <- renderPlot({
plot(hc.sin, main="Detected Antigens Single Linkage",xlab="",sub="",cex=.7)
})
output$plot_vaccine_coverage_reg <- renderPlot({
lm_scatter_plot + geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", size = 1, data = VC_filtered_numeric)
})
output$plot_vaccine_coverage_cluster <- renderPlot({
vac_cover_cluster_plot
})
output$text_output <- renderText({
"Project Question: Goal is to determine the effectiveness of the influenza vaccine as the virus has mutated over time."
})
output$html_output <- renderUI({
tags$div(
tags$h2("Project Overview", tags$br()),
tags$p(tags$br(),
tags$br(),
"Our goal is to determine the effectiveness of the influenza vaccine as the virus has mutated over time.
We want to get a comprehensive understanding of relationship between influenza vaccines and influenza mutations.
Vaccines for influenza must be altered and adjusted every year based on mutation.
We want to try to find patterns that can guide how the most effective vaccines are built,
and what are common factors that might cause a strain of influenza to mutate more rapidly or unpredictably
over time. Because of the volume of influenza data available, and the advancement in collection of
medical data in the recent years, our analysis will likely have to be limited to the 2000 and beyond,
or some other significant year deadline, and we expand from there. Data will also most likely be
condensed to North America or the United States, once again for data volumeâ€™s sake.",
tags$br()),
tags$h2("Data Sources", tags$br()),
tags$p(tags$br(),
"The data used for this analysis is publicly available through the ", tags$a("World Health Organization",href="https://www.who.int"),",
the", tags$a("Center for Disease Control and Prevention",href = "https://www.cdc.gov/index.htm"),", and ", tags$a("National Center for Biotechnology Information",href="https://www.ncbi.nlm.nih.gov/"),".
The data from the ", tags$a("World Health Organization",href="https://www.who.int")," is available as a CSV file (", tags$a("Data Download",href = "https://xmart-api-public.who.int/FLUMART/VIW_FNT?$format=csv"),") and also contained
a data dictionary in CSV format (", tags$a("Data Dictionary Download",href = "https://xmart-api-public.who.int/FLUMART/VIW_FLU_METADATA?$format=csv&$filter=contains(DatasetName,%20%27FluNet%27"),"). This data set contains weekly totals of
world wide influenza cases on a country level from the year 1995 to 2024.
The data set includes the country, region, start date (start of week being measured), and each flu strains
weekly total, to name a few. There are 52 sets of weekly flu case totals per country per year, as each week
of the year gets recorded separately for each country.
The data from the Center for Disease Control and
Prevention has multiple different data sets available for use:",
tags$br(), tags$br(),
tags$a("Death Data",href="https://data.cdc.gov/NCHS/Provisional-Death-Counts-for-Influenza-Pneumonia-a/ynw2-4viq/about_data"),":", tags$a("Data Download",href = "https://data.cdc.gov/resource/ynw2-4viq.csv"),
tags$br(), tags$br(),
tags$a("Vaccination Data",href="https://data.cdc.gov/Flu-Vaccinations/Influenza-Vaccination-Coverage-for-All-Ages-6-Mont/vh55-3he6/about_data"),":", tags$a("Data Download",href="https://data.cdc.gov/resource/vh55-3he6.csv"),
tags$br(), tags$br(),
"The death data set contains death counts for influenza, pneumonia, and COVID-19 by week ending dates for
each state, region, and age group in the United States.
The vaccination data set contains data on influenza vaccination coverage for people by region, state, age,
and race in the United States.
The death data set contains 50,400 entries and the vaccination data set contains 204,000 entries.
The data we gather from the ", tags$a("National Center for Biotechnology Information",href="https://www.ncbi.nlm.nih.gov/"), "was gathered using their query system.
We gathered information on nucleotides and protein coding sequences.",
tags$br(), tags$br(),
tags$a("NCBI",href="https://www.ncbi.nlm.nih.gov/"),":", tags$a("Data Query System",href="https://www.ncbi.nlm.nih.gov/genomes/FLU/Database/nph-select.cgi?go=database"),
tags$br(), tags$br(),
"The goal for data wrangling is to find ways to extract information from each data set
do find further insights and ways the data sets relate. The data will remain in flat files
until a database storage method is determined.",
tags$br())
)
})
}
# Run the application
shinyApp(ui = ui, server = server)
320*0.75
320*1.25
18**2
12*-24
324+288
sqrt(612)
612/4
sqrt(153)
x = 3 + sqrt(612)/6
y = 3 + sqrt(612)/6
y = 3 - sqrt(612)/6
x
y
f = function(x){return (2*x**3 - 9*x**2 - 24*x-12)}
f(x)
f(y)
f(4)
f(-1)
setwd("~/")
reticulate::repl_python()
reticulate::repl_python()
reticulate::repl_python()
setwd("D:/Clancy Documents/School/UW/Autumn 2025/AMATH 581/Final Project/Computational-Notebook")
